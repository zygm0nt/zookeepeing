Based on:
http://cyberroadie.wordpress.com/2011/12/20/zookeeper-single-file-leader-election-with-retry-logic/