Based on:
http://cyberroadie.wordpress.com/2011/11/24/implementing-leader-election-with-zookeeper/